LAMMPS (30 Jul 2016-ICMS)
WARNING: OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (../comm.cpp:90)
  using 1 OpenMP thread(s) per MPI task
# Bead-spring polymer simulation with small-molecule diffusion - lj
# 160-mers
# 25 chains
# FENE potential repulsive all sites, with interactive temperature

units lj

shell	       echo 1.0 > Tempfile.txt
shell	       echo 1.0 > Bondfile.txt

variable       myTempStr file Tempfile.txt
variable       myTemp equal v_myTempStr

variable       myBondStr file Bondfile.txt
variable       myBond equal v_myBondStr


neighbor	0.4 bin
neigh_modify	every 1 delay 5 check yes

atom_style 	molecular

comm_modify	cutoff 5.0

# soft potential for initial pushoff
pair_style	lj/cut 1.12246
pair_modify	shift yes
bond_style	harmonic

# filename of the data-file (or restart-file) to be used
#read_data	newdataNbead160.txt
read_restart	restartsoft1
WARNING: Restart file used different # of processors (../read_restart.cpp:717)
  orthogonal box = (-8.37884 -8.37884 -8.37884) to (8.37884 8.37884 8.37884)
  1 by 2 by 2 MPI processor grid
  4000 atoms
  3975 bonds
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors

# pair coefficients
pair_coeff	* * 1.0 1.0
#pair_coeff	* * 10.0

bond_coeff	* 500.0 1.0

#special_bonds	lj 0.0 1.0 1.0

# set the timestep in the specified units
timestep	0.001

thermo_style	one

# set the parameters here
fix 1 all nve/limit 0.01
fix 3 all langevin v_myTemp 1.0 1.0 39253

thermo		100
run 10000
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 5 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.4
  ghost atom cutoff = 5
  binsize = 0.7 -> bins = 24 24 24
Memory usage per processor = 6.13912 Mbytes
Step Temp E_pair E_mol TotEng Press 
    5000   0.98812801 0.0036090128    2.4713654    3.9567958  -0.78487424 
    5100    1.6289003  0.016389823    1.2982073    3.7573368   0.28771837 
    5200    1.5525924  0.042360951    1.2280407    3.5987079 -0.078090338 
    5300    1.4864299  0.072458928    1.1546492    3.4561955   0.88465873 
    5400    1.3887087   0.10257589     1.136099    3.3212172  -0.15725156 
    5500    1.3464743   0.12434273    1.0760561    3.2196054   0.31178754 
    5600    1.3162167    0.1455539    1.0053062    3.1246915   0.17020233 
    5700    1.2727699   0.15852951   0.97879002    3.0459971   -0.1276797 
    5800    1.2621992   0.16754647   0.92053156    2.9809035   0.39558444 
    5900     1.234746   0.17718467   0.87890817    2.9077487   0.25745902 
    6000    1.2096079   0.18275545   0.84807301    2.8447868   0.66053897 
    6100    1.2074473   0.18618131   0.80249023    2.7993898   0.43418511 
    6200    1.1721174   0.18657654   0.78605073    2.7303638   0.57990475 
    6300    1.1533532   0.18281145   0.75275726    2.6651661   0.30339748 
    6400    1.1452531   0.18297199   0.72351408    2.6239363   0.17211343 
    6500     1.133708   0.18201819   0.70634241    2.5884975   0.39749082 
    6600     1.123931   0.18261916   0.67618339    2.5442775   0.31752042 
    6700    1.1160891   0.18169377    0.6811287    2.5365376   0.42816829 
    6800    1.1057533   0.18071574   0.64755794     2.486489    0.2194697 
    6900    1.0876289   0.18291983   0.63079254    2.4447478   0.31857184 
    7000     1.089692   0.18345451   0.61191417     2.429498   0.25286791 
    7100    1.0866611   0.18816901    0.5953828     2.413136   0.17792251 
    7200    1.0629061   0.19158571      0.60818    2.3937263   0.54996808 
    7300    1.0624278    0.1899058   0.58664667    2.3697957   0.67231582 
    7400    1.0557703   0.18998517   0.59264177    2.3658865 -0.014487618 
    7500    1.0562065   0.18915827    0.5743049    2.3473769   0.34802077 
    7600    1.0506647   0.19001307   0.55898113    2.3245972   0.37489953 
    7700    1.0500032   0.19050375   0.56167215     2.326787    0.2424732 
    7800    1.0426527   0.19064668   0.55415337     2.308388   0.42438972 
    7900    1.0444705     0.192314   0.53841424    2.2970423   0.26507109 
    8000     1.033819   0.19425784    0.5620182    2.3066168  0.060110686 
    8100    1.0243408   0.20098656   0.56140355    2.2985171   0.39995077 
    8200    1.0194845   0.20463061   0.56296047    2.2964355   0.54147086 
    8300    1.0264359   0.20184183   0.55768618    2.2987969   0.32638484 
    8400    1.0254342   0.19681975   0.55627981    2.2908663   0.59055545 
    8500    1.0107283   0.19649773   0.55387364    2.2660848   0.26095935 
    8600    1.0006562   0.19511944   0.55813529    2.2538638   0.37375206 
    8700    1.0265836   0.19454922   0.51312689    2.2471665   0.48867335 
    8800    1.0171549   0.19237166   0.51972901    2.2374516   0.53095996 
    8900    1.0037347   0.19127757   0.53599898    2.2325021  0.048177165 
    9000    1.0044581   0.19080394   0.53855527    2.2356696   0.35052139 
    9100    1.0324206   0.18964588   0.51536036      2.25325   0.39323979 
    9200    1.0324236   0.19367827   0.51266636    2.2545928   0.47177039 
    9300     1.010441   0.20024483   0.53401485    2.2495423   0.39104253 
    9400    1.0125789   0.20399074   0.50783364     2.230313   0.35842731 
    9500    1.0142099   0.20605688   0.51136838    2.2383599   0.25370281 
    9600    1.0128632   0.20600773   0.50112548    2.2260483   0.44126686 
    9700   0.99687212   0.20560006   0.52068521    2.2212196   0.41461193 
    9800   0.99838898   0.20570139   0.50258612    2.2054966   0.30266745 
    9900    1.0023021   0.20475635   0.50257715    2.2104108   0.45245936 
   10000    0.9970009   0.20343501   0.51109996    2.2096624   0.24029446 
   10100    1.0118222   0.20307315   0.48780156    2.2082286   0.42806875 
   10200    1.0178813   0.20167996   0.49461046    2.2227307   0.25181382 
   10300    1.0153629   0.20367092   0.49041564    2.2167502   0.46289021 
   10400    1.0030869   0.20784134   0.50678298    2.2188785   0.19002156 
   10500    1.0101964   0.20687464   0.50513421    2.2269246    0.6924079 
   10600   0.99253856   0.20710472   0.52075336    2.2162937  0.031173725 
   10700    1.0072308   0.20494818    0.4932542    2.2086709   0.36093981 
   10800   0.98880771   0.20488975   0.51910879    2.2068393  0.071359617 
   10900    1.0095994   0.20512802    0.4779347    2.1970831   0.33180959 
   11000    1.0017315   0.20758943   0.50597741    2.2157884     0.321571 
   11100    1.0228346   0.20561495   0.49348277    2.2329661   0.49674495 
   11200    1.0055678   0.20472056   0.50513434    2.2178296   0.37639337 
   11300    1.0137804   0.20378362     0.503787    2.2278611   0.29724444 
   11400    1.0127347   0.20308206   0.51467468     2.236479   0.26436281 
   11500     1.018944   0.20179992   0.49318711     2.223021   0.21883245 
   11600     1.004671   0.20242268   0.50966599    2.2187184   0.54866534 
   11700    1.0060655   0.20382965   0.51012059    2.2226713   0.43204507 
   11800    1.0137721   0.20682104   0.48457301    2.2116721   0.52849085 
   11900    1.0055141   0.20889639    0.4980327    2.2148231   0.30124472 
   12000    1.0089814   0.20818257   0.49450661    2.2157829  0.049425159 
   12100   0.99485153   0.21299703   0.49603761    2.2009389   0.26629719 
   12200    1.0004621   0.21289623   0.49604409    2.2092583   0.58559097 
   12300   0.99137533   0.21440679   0.50246725    2.2035653   0.28824959 
   12400    1.0019736   0.21505183   0.48502547    2.2026619   0.43902429 
   12500   0.98026095   0.22012676    0.5092403    2.1993909   0.22731311 
   12600   0.98406435   0.21964092   0.49923452    2.1946029   0.47864977 
   12700    1.0113996   0.21593413   0.49195123    2.2246055   0.17168755 
   12800    1.0208915   0.21309424   0.51042759    2.2544762   0.31137722 
   12900    1.0144042   0.21252969   0.51526756    2.2490231   0.16788724 
   13000    1.0150373   0.20801405   0.50542261    2.2356119   0.61505001 
   13100    1.0128352   0.20610315   0.51669286     2.241669   0.33044012 
   13200    1.0024036   0.20778687   0.50894445    2.2199608   0.11494985 
   13300    1.0057756   0.20771639    0.5159028    2.2319054   0.57711623 
   13400     1.007276   0.21000442   0.49917909    2.2197197   0.68944929 
   13500    1.0020536   0.21096184   0.50939787    2.2230643   0.28467895 
   13600    1.0064778   0.21253808   0.49188114    2.2137585   0.37978275 
   13700    0.9957663   0.21044723    0.4988732    2.2025965   0.50449848 
   13800    1.0013647   0.20550445   0.49029831    2.1974743    0.3993053 
   13900    1.0131727   0.20426457   0.48058414    2.2042279   0.49875796 
   14000    1.0050986   0.20363892   0.49476352    2.2056734   0.33031404 
   14100    1.0179613   0.20282139   0.46546134     2.194843   0.41028744 
   14200   0.98718448   0.20133436   0.51364561    2.1953865   0.21452943 
   14300    1.0085294   0.20248961   0.47102888    2.1859343   0.36301943 
   14400   0.99736016   0.20509798   0.49329674     2.194061   0.33296038 
   14500    1.0053221   0.20681879   0.49473417    2.2091591   0.32440596 
   14600    1.0070861   0.20805389   0.50786515    2.2261706   0.29791357 
   14700    0.9988121   0.20983467   0.50709194    2.2147702   0.60834054 
   14800    1.0187282    0.2119913   0.49036907    2.2300707   0.43201246 
   14900    1.0134909   0.20874799   0.49466874    2.2232731   0.37716282 
   15000    1.0221818   0.21102677   0.48292681    2.2268429   0.37443801 
Loop time of 6.90117 on 4 procs for 10000 steps with 4000 atoms

Performance: 125196.213 tau/day, 1449.030 timesteps/s
88.5% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.1865     | 1.2235     | 1.2603     |   2.8 | 17.73
Bond    | 0.32342    | 0.32827    | 0.33246    |   0.6 |  4.76
Neigh   | 0.38794    | 0.39277    | 0.4045     |   1.1 |  5.69
Comm    | 3.2006     | 3.2551     | 3.2913     |   2.0 | 47.17
Output  | 0.0061641  | 0.010356   | 0.022343   |   6.8 |  0.15
Modify  | 0.86591    | 0.90069    | 0.95783    |   3.6 | 13.05
Other   |            | 0.7904     |            |       | 11.45

Nlocal:    1000 ave 1040 max 963 min
Histogram: 1 0 0 1 0 1 0 0 0 1
Nghost:    6731 ave 6821 max 6640 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    3197.75 ave 3397 max 2941 min
Histogram: 1 0 0 0 0 1 1 0 0 1

Total # of neighbors = 12791
Ave neighs/atom = 3.19775
Ave special neighs/atom = 5.925
Neighbor list builds = 217
Dangerous builds = 0

unfix 1

fix 4 all nve

# set Interactive Molecular Dynamics

fix com all imd 5678 trate 5 unwrap on #fscale #10.0

reset_timestep 	0

# change the 8000 to change how often to save the positions of the atoms
#dump 		1 all custom 500 position_imd.lammpstrj id type xs ys zs ix iy iz

# how often to output thermodynamic data

# how often to outout restart files and their names
#restart       5000000 restartimd1 restartimd2

label          loop2here

# specifies the run length in timesteps
run            2000
Memory usage per processor = 6.45358 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0    1.0221818   0.21102677   0.48292681    2.2268429   0.37443801 
     100    1.0182551   0.21329444   0.47264148    2.2129367   0.39435957 
     200   0.98613164   0.21423577   0.51813277    2.2111962   0.27864402 
     300   0.99727772   0.21013644   0.48614127    2.1918203   0.61558883 
     400   0.98893214   0.21047199   0.49023516    2.1837345   0.17430309 
     500   0.97885748   0.20708921   0.49254004    2.1675484   0.31956907 
     600   0.98193868   0.20525042   0.50170901    2.1794992   0.46885854 
     700    0.9753362   0.20321192   0.49745447    2.1633049   0.28437041 
     800   0.98265046   0.20323133   0.48998013    2.1668187   0.24999066 
     900   0.97674228   0.20234719   0.49770345    2.1647978   0.17884367 
    1000    0.9926707   0.19991072   0.47375547       2.1623   0.67276893 
    1100   0.99950842   0.19961874    0.4891168    2.1876234   0.35368859 
    1200    0.9959139   0.20312053   0.50851781    2.2051357 -0.090305012 
    1300    1.0095354   0.20746281   0.49229693    2.2136842   0.65186898 
    1400   0.99652655   0.20858238   0.50664924    2.2096477   0.15559589 
    1500    1.0028298   0.20720598   0.48754071    2.1986153   0.71824647 
    1600    1.0054869   0.21050809    0.4944297     2.212791   0.38564073 
    1700   0.99870069   0.21320217   0.50058868    2.2114674   0.23523086 
    1800    1.0005033    0.2158713   0.49801846    2.2142696   0.19699396 
    1900    0.9943337   0.21177874   0.50378262     2.206689   0.43292541 
    2000    1.0004506   0.20831328   0.50105695     2.209671   0.27926446 
Loop time of 2.08392 on 4 procs for 2000 steps with 4000 atoms

Performance: 82920.844 tau/day, 959.732 timesteps/s
83.2% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.256      | 0.2758     | 0.29448    |   3.5 | 13.23
Bond    | 0.055949   | 0.064231   | 0.071887   |   2.4 |  3.08
Neigh   | 0.088381   | 0.090972   | 0.095188   |   0.8 |  4.37
Comm    | 0.89438    | 0.95513    | 0.99188    |   4.0 | 45.83
Output  | 0.0022283  | 0.0031114  | 0.004225   |   1.3 |  0.15
Modify  | 0.36889    | 0.44641    | 0.56494    |  10.8 | 21.42
Other   |            | 0.2483     |            |       | 11.91

Nlocal:    1000 ave 1038 max 975 min
Histogram: 1 1 0 0 1 0 0 0 0 1
Nghost:    6727 ave 6757 max 6709 min
Histogram: 2 0 0 0 1 0 0 0 0 1
Neighs:    3174.75 ave 3476 max 2974 min
Histogram: 1 0 1 1 0 0 0 0 0 1

Total # of neighbors = 12699
Ave neighs/atom = 3.17475
Ave special neighs/atom = 5.925
Neighbor list builds = 44
Dangerous builds = 0
shell          head -n 2 Temp.txt | tail -n 1 >> Tempfile.txt
shell          head -n 2 Bond.txt | tail -n 1 >> Bondfile.txt
next           myTempStr
next           myBondStr
if "${myBond} == 0" then "jump imdinput.txt breakbonds"
if "${myBond} <= -1" then "jump imdinput.txt nobonds"
jump           imdinput.txt loop2here

# specifies the run length in timesteps
run            2000
Memory usage per processor = 6.45457 Mbytes
Step Temp E_pair E_mol TotEng Press 
    2000    1.0004506   0.20831328   0.50105695     2.209671   0.27926446 
    2100    1.0100818   0.20335579   0.49978536    2.2178851   0.41809154 
    2200    1.0140554   0.20148194   0.51427008    2.2364549  0.069563207 
    2300    1.0197868   0.20301399   0.52642072    2.2587325   0.31021405 
    2400    1.0240688   0.20439132   0.54088526    2.2809958   0.44013226 
    2500    1.0526177   0.20667258   0.52089409    2.3060985   0.42842586 
    2600    1.0623849   0.20713435   0.51575194    2.3160653   0.24915476 
    2700    1.0626205   0.20929387   0.50088727    2.3037135   0.39466043 
    2800    1.0441575   0.20913423   0.51831599    2.2932948   0.25074613 
    2900    1.0271928   0.20815084   0.52023695    2.2687919   0.26866708 
    3000    1.0167609   0.20751128   0.51361554    2.2458869   0.16298941 
    3100    1.0049376   0.20739613   0.52182839     2.236254   0.44777227 
    3200    1.0249285   0.21010227   0.50624465    2.2533553   0.56555649 
    3300    1.0199324   0.21203425   0.50887625    2.2504266   0.35249337 
    3400    1.0191109   0.21356047   0.51300637     2.254851   0.40296984 
    3500    1.0261158   0.21386213   0.50271714    2.2553682  0.078246238 
    3600    1.0035348   0.21653037   0.50040818    2.2218645   0.36849189 
    3700     1.008892   0.21315942   0.50820485     2.234324   0.40544956 
    3800     1.016763    0.2104213   0.49966219    2.2348467   0.36662248 
    3900   0.99936527    0.2127722   0.50298345    2.2144288   0.27514747 
    4000   0.98959741   0.21309515   0.49311795    2.1902381   0.32071336 
Loop time of 2.11941 on 4 procs for 2000 steps with 4000 atoms

Performance: 81532.171 tau/day, 943.659 timesteps/s
83.4% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.26306    | 0.28847    | 0.34898    |   6.5 | 13.61
Bond    | 0.055425   | 0.064561   | 0.068604   |   2.1 |  3.05
Neigh   | 0.17354    | 0.18029    | 0.19067    |   1.6 |  8.51
Comm    | 0.94719    | 1.0053     | 1.0382     |   3.6 | 47.43
Output  | 0.001538   | 0.0024028  | 0.0032706  |   1.3 |  0.11
Modify  | 0.33159    | 0.37077    | 0.44093    |   6.8 | 17.49
Other   |            | 0.2076     |            |       |  9.79

Nlocal:    1000 ave 1035 max 972 min
Histogram: 1 0 0 1 1 0 0 0 0 1
Nghost:    6683.25 ave 6705 max 6662 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    3157 ave 3460 max 2963 min
Histogram: 1 1 0 1 0 0 0 0 0 1

Total # of neighbors = 12628
Ave neighs/atom = 3.157
Ave special neighs/atom = 5.925
Neighbor list builds = 73
Dangerous builds = 0
shell          head -n 2 Temp.txt | tail -n 1 >> Tempfile.txt
shell          head -n 2 Bond.txt | tail -n 1 >> Bondfile.txt
next           myTempStr
next           myBondStr
if "${myBond} == 0" then "jump imdinput.txt breakbonds"
if "${myBond} <= -1" then "jump imdinput.txt nobonds"
jump           imdinput.txt loop2here

# specifies the run length in timesteps
run            2000
Memory usage per processor = 6.45359 Mbytes
Step Temp E_pair E_mol TotEng Press 
    4000   0.98959741   0.21309515   0.49311795    2.1902381   0.32071336 
    4100   0.99356205      0.21297   0.50616835    2.2091088   0.57817813 
    4200   0.99187377   0.21697616   0.50324553    2.2076604   0.32232349 
    4300    1.0062809   0.21727522    0.4966806    2.2229999   0.35705978 
    4400    1.0222607   0.21621402   0.50707145    2.2562932   0.30766574 
    4500   0.99833362   0.21297165   0.50937272    2.2194704   0.47593767 
    4600    1.0082318   0.21233665   0.50453201    2.2288383    0.1676196 
    4700   0.99243281   0.21640727   0.51038427    2.2150686    0.3252876 
    4800    1.0013112   0.21604219    0.5132484     2.230882   0.36050806 
    4900    1.0201329   0.21498678   0.49355767    2.2383613   0.11273137 
    5000    1.0222123   0.21623576   0.50467569    2.2538466   0.37536724 
    5100     1.014292   0.21730593   0.50414846    2.2425121   0.55089559 
    5200    1.0026957     0.215677   0.51598718    2.2353318   0.53848797 
    5300    0.9980507   0.21378494   0.50587688    2.2163636   0.21950121 
    5400     1.001992   0.21043575   0.49609203      2.20914   0.33120012 
    5500    1.0162547   0.20457316   0.49228152    2.2208557   0.53333928 
    5600     1.014066   0.20153579   0.48696247     2.209217   0.32152703 
    5700    1.0043386   0.20372655   0.47905553    2.1889134   0.31071992 
    5800    0.9810227   0.20351477   0.49373422    2.1684152   0.28361134 
    5900    1.0098074   0.20499459   0.49005164    2.2093787   0.24670052 
    6000    1.0068556   0.20605752   0.49196529    2.2079286   0.44063349 
Loop time of 2.12934 on 4 procs for 2000 steps with 4000 atoms

Performance: 81151.936 tau/day, 939.259 timesteps/s
80.2% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2379     | 0.27983    | 0.31862    |   6.3 | 13.14
Bond    | 0.057687   | 0.059684   | 0.062863   |   0.8 |  2.80
Neigh   | 0.084686   | 0.085983   | 0.087345   |   0.3 |  4.04
Comm    | 0.83658    | 0.89796    | 0.94726    |   4.5 | 42.17
Output  | 0.0018935  | 0.0052415  | 0.011755   |   5.4 |  0.25
Modify  | 0.42083    | 0.48894    | 0.64026    |  12.6 | 22.96
Other   |            | 0.3117     |            |       | 14.64

Nlocal:    1000 ave 1041 max 969 min
Histogram: 1 0 0 1 1 0 0 0 0 1
Nghost:    6659.5 ave 6697 max 6631 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Neighs:    3096 ave 3394 max 2886 min
Histogram: 1 0 0 2 0 0 0 0 0 1

Total # of neighbors = 12384
Ave neighs/atom = 3.096
Ave special neighs/atom = 5.925
Neighbor list builds = 42
Dangerous builds = 0
